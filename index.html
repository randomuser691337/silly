<!DOCTYPE html>
<html lang="en">
<!--I don't know what I'm doing, feel free to message me with bugfixes-->

<head>
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="stylesheet" href="./assets/stylep2.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="shortcut icon" href="./assets/img/favicon.png">
    <link rel="apple-touch-icon" href="./assets/img/noround.png">
    <title>WebDesk</title>
    <script>
        var dbn = "WebDeskDB";
        var ver = "0.0.9";
        var lastedit = "July 26, 2024";
        var locked = true;
        var fname;
        var fblob;
        var enc;
        var nvol = 1.0;
        var copied;
        var copiedn;
        var sdone = false;
        var user = "WebDesk User";
        var silent = false;
        var dark = false;
        const titleStyle = 'color: white; background: #881111; font-size: 16px; font-weight: bold; padding: 10px; border-radius: 40px;';
        const warningStyle = 'color: white; font-size: 13px; font-weight: bold;';
        console.log('%c=== WebDesk 0.0.9 ===', titleStyle);
        console.log(`%c<!> Don\'t paste random code here,
because WebDesk can be compromised. Your 
data, passwords, etc can be stolen!`, warningStyle);

    </script>
</head>

<body>
    <div id="deathcurtain"
        style="z-index: 9999; position: fixed; left: 0px; top: 0px; bottom: 0px; right: 0px; background-color: #000;">
    </div>
    <div id="prohibit"
        style="z-index: 9999; position: fixed; left: 0px; top: 0px; bottom: 0px; right: 0px; background-color: #000; display: none;">
        <div style="position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%);">
            <img src="./assets/img/warn.svg" style="width: 100px; margin-bottom: 3px; filter: invert(1);"></img>
            <p><a class="bold" id="perr" href="https://errdesk.vercel.app?e=what"
                    style="color: #fff !important;">errdesk.vercel.app</a></p>
        </div>
    </div>
    <div id="oobespace">
        <div id="setupbg" onmousedown="unlock('setupbg');showf('setup', 0);dest('setupgo', 500);">
            <div id="sorryapple">
                <svg id="hellosvg" viewBox="0 0 1230.94 414.57">
                    <path
                        d="M-293.58-104.62S-103.61-205.49-60-366.25c9.13-32.45,9-58.31,0-74-10.72-18.82-49.69-33.21-75.55,31.94-27.82,70.11-52.22,377.24-44.11,322.48s34-176.24,99.89-183.19c37.66-4,49.55,23.58,52.83,47.92a117.06,117.06,0,0,1-3,45.32c-7.17,27.28-20.47,97.67,33.51,96.86,66.93-1,131.91-53.89,159.55-84.49,31.1-36.17,31.1-70.64,19.27-90.25-16.74-29.92-69.47-33-92.79,16.73C62.78-179.86,98.7-93.8,159-81.63S302.7-99.55,393.3-269.92c29.86-58.16,52.85-114.71,46.14-150.08-7.44-39.21-59.74-54.5-92.87-8.7-47,65-61.78,266.62-34.74,308.53S416.62-58,481.52-130.31s133.2-188.56,146.54-256.23c14-71.15-56.94-94.64-88.4-47.32C500.53-375,467.58-229.49,503.3-127a73.73,73.73,0,0,0,23.43,33.67c25.49,20.23,55.1,16,77.46,6.32a111.25,111.25,0,0,0,30.44-19.87c37.73-34.23,29-36.71,64.58-127.53C724-284.3,785-298.63,821-259.13a71,71,0,0,1,13.69,22.56c17.68,46,6.81,80-6.81,107.89-12,24.62-34.56,42.72-61.45,47.91-23.06,4.45-48.37-.35-66.48-24.27a78.88,78.88,0,0,1-12.66-25.8c-14.75-51,4.14-88.76,11-101.41,6.18-11.39,37.26-69.61,103.42-42.24,55.71,23.05,100.66-23.31,100.66-23.31"
                        transform="translate(311.08 476.02)"
                        style="fill:none;stroke:#fff;stroke-linecap:round;stroke-miterlimit:10;stroke-width:35px" />
                </svg>
                <p class="bold"
                    style="font-size: 16px; margin-top: 8px; color: #fff; margin-top: 8px; animation: fucker 4.3s;">
                    Press to open</p>
            </div>
        </div>
        <div id="setupgo"
            style="position: fixed; left: 0px; top: 0px; bottom: 0px; right: 0px; background-color: #000; z-index: -1;">
        </div>
        <div class="setup" style="width: 500px; height: 360px; display: none;" id="setup">
            <div class="setupbar" id="setupbar1">
                <div class="tnav"><button class="b4" onclick="eprompt();">Start Over</button></div>
                <div class="title"><button class="time b4"
                        onclick="if (locked === false) {fesw('setupbar1', 'setupbar2');}"
                        style="background-color: transparent !important;">--:--</button></div>
            </div>
            <div class="setupbar" style="display: none;" id="setupbar2">
                <div class="tnav"><button class="b4" onclick="fesw('setupbar2', 'setupbar1');">Back</button><button
                        class="b4" onclick="opapp('term');">Terminal</button><button class="b4"
                        onclick="opapp('settings');">Settings</button></div>
                <div class="title"><button class="time b4" style="background-color: transparent !important;"></button>
                </div>
            </div>
            <div id="setupre" class="setupp hide">
                <img class="setupi" src="./assets/img/setup/restore.svg"></img>
                <p class="h3">WebDesk Restore</p>
                <p>Have a WebDesk backup ready, as we'll need it to restore. An error occured, which is why we're here.
                </p>
                <button class="b1" onclick="window.location.href = './index.html';">Cancel</button><button class="b1"
                    onclick="fesw('setupre', 'setup2');">Next</button>
            </div>
            <div id="setup1" class="setupp">
                <img class="setupi" src="./assets/img/setup/first.svg"></img>
                <p class="h3">Welcome to WebDesk!</p>
                <p class="med">Note: This version is no longer updated or secured, please use <a href="https://another-webdesk.vercel.app">the latest version.</a></p>
                <button class="b1" onclick="guestmode();">Guest</button><button class="b1"
                    onclick="fesw('setup1', 'setup2');">Let's go!</button>
            </div>
            <div id="setup2" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/enc.svg"></img>
                <p class="h3">Encryption</p>
                <p>Being unencrypted is significantly faster, but data isn't secured.</p>
                <p>Encryption keeps your data safe behind a password.</p>
                <button class="b1 resthide" onclick="fesw('setup2', 'setup1');">Back</button><button class="b1"
                    onclick="writepb('enc', 'y'); enc = 'y'; fesw('setup2', 'setups');">Encrypt</button><button
                    class="b1" onclick="writepb('enc', 'n');fesw('setup2', 'setupqs'); enc = 'n';">Don't
                    encrypt</button>
            </div>
            <div id="setupqs" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/quick.png"></img>
                <p class="h3">Quick Start</p>
                <p>If you have an existing WebDesk, you can copy your data.</p>
                <p class="resthide">Other WebDesk: open Backup app -> Migrate -> enter code below:</p>
                <p class="h2 mcode resthide" style="margin-bottom: 3px;">----</p>
                <button class="b1" onclick="filepickl('.zip', async function (file) {await restorefs(file);});">Local
                    restore</button><button class="b1 resthide" onclick="fesw('setupqs', 'setupn');">No thanks</button>
            </div>
            <div id="setuprs" class="hide setupp">
                <p class="h3">Restoring...</p>
                <p>Please wait. This might take a while depending on file size and encryption.</p>
                <p class="restpg">Starting restore...</p>
            </div>
            <div id="setups" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/pass.svg"></img>
                <p class="h3">Password Setup</p>
                <p>Enter a password to decrypt WebDesk with.</p>
                <p>Don't lose this pass, as your data is lost without it.</p>
                <input type="password" id="oobep" class="i1" placeholder="Password here" />
                <button class="b1"
                    onclick="const p = document.getElementById('oobep').value; setupde(p); fesw('setups', 'setupqs');">Set
                    password</button>
            </div>
            <div id="setupn" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/user.svg"></img>
                <p class="h3">User Setup</p>
                <p>Enter a username to use with WebDesk.</p>
                <input class="i1" id="ooben" placeholder="Username here"></input>
                <button class="b1"
                    onclick="const n = document.getElementById('ooben').value;writef('/user/info/name', n);fesw('setupn', 'setupc');">Set
                    username, next!</button>
            </div>
            <div id="setupc" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/color.svg"></img>
                <p class="h3">Appearance</p>
                <p>Select an accent color, and a theme.</p>
                <p class="bold">Accent color</p>
                <button class="acb" style="background: rgb(210, 30, 30);" onclick="chacc('210, 30, 30');"></button>
                <button class="acb" style="background: rgb(210, 120, 30);" onclick="chacc('210, 120, 30');"></button>
                <button class="acb" style="background: rgb(210, 180, 20);" onclick="chacc('210, 180, 20');"></button>
                <button class="acb" style="background: rgb(50, 160, 20);" onclick="chacc('50, 160, 20');"></button>
                <button class="acb" style="background: rgb(40, 70, 235);" onclick="chacc('40, 70, 235');"></button>
                <button class="acb" style="background: rgb(120, 60, 235);" onclick="chacc('120, 60, 235');"></button>
                <button class="acb" style="background: rgb(200, 200, 200);" onclick="chacc('200, 200, 200');"></button>
                <p class="bold">Theme</p>
                <button class="b1" onclick="appear('l');">Light mode</button><button class="b1" onclick="appear();">Dark
                    mode</button>
                <p><button class="b1" onclick="fesw('setupc', 'setupo');setupd();">Done</button></p>
            </div>
            <div id="setupo" class="hide setupp">
                <img class="setupi" src="./assets/img/noround.png"></img>
                <p class="h3">WebDesk Online Services</p>
                <p>WebDesk has online features that require a unique ID.</p>
                <p>Features provided are: WebDrop, Migration Assistant, Store</p>
                <p>To access these, a DeskID is created, which is your unique ID that you can share to connect with
                    others.</p>
                <button class="b1" onclick="showf('contcent');">View DeskID</button><button class="b1"
                    onclick="fesw('setupo', 'setupl');">Done</button>
            </div>
            <div id="setupl" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/location.svg"></img>
                <p class="h3">Location Services</p>
                <p>You can enable Location Services, to update the weather, use certain
                    weather info to dynamically adjust WebDesk, and possibly more in the future.</p>
                <p>Your location is only processed through OpenWeatherMap. This info is not sent or
                    collected by WebDesk.</p>
                <input class="i1" placeholder="Enter your city" id="oobeloc"></input>
                <button class="b1" onclick="fesw('setupl', 'setupf');">No thanks</button><button class="b1"
                    onclick="fesw('setupl', 'setupf'); writef('/user/info/city', document.getElementById('oobeloc').value);">Done</button>
            </div>
            <div id="setupf" class="hide setupp">
                <img class="setupi" src="./assets/img/setup/check.svg"></img>
                <p class="h3">Setup is done!</p>
                <p>Click "Reboot" to finish. Have fun!</p>
                <p class="optnote">Note: If you encrypted, WebDesk will ask for your password.</p>
                <button class="b1" onclick="reboot(200);">Reboot</button>
            </div>
            <div id="setupa" class="hide setupp">
                <div id="setupa1">
                    <p class="authcont h3">Enter password to continue.</p>
                    <p>If you forgot, <a onclick="eprompt();">erase WebDesk to continue</a>.</p>
                    <p class="hide migalert med">After unlocking, your data will be copied to the new WebDesk and this
                        process can't be stopped.</p>
                    <input id="authp" class="i1" type="password" autocorrect="off" placeholder="Password here"></input>
                    <button class="b1" onclick="eprompt();">I forgot</button><button class="b1"
                        onclick="authg();">OK</button>
                </div>
                <div id="setupa2" class="hide">
                    <img class="setupi" src="./assets/img/setup/check.svg"></img>
                    <p class="authcont h3">Welcome back!</p>
                    <p>If you can't get in, <a onclick="window.location.href = './rec.html';">enter Recovery</a> or
                        click "Start Over".</p>
                    <p class="hide migalert med">After unlocking, your data will be copied to the new WebDesk and this
                        process can't be stopped.</p>
                    <p><button class="controlb" onclick="boots2();" style="margin-top: 8px;">Unlock</button></p>
                </div>
            </div>
        </div>
    </div>
    <div id="flash"
        style="position: fixed; z-index: 9999; left: 0px; right: 0px; top: 0px; bottom: 0px; background-color: #fff; display: none;">
    </div>
    <div class="window" id="camera" style="width: 280px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('camera');nocam();"></div>
                <div class="winb yel" onmousedown="mini('camera');"></div>
                <div class="winb"></div>
            </div>
            <div class="title camtime">Camera</div>
        </div>
        <div class="content">
            <div id="enablecam">
                <p>WebDesk needs camera permission to open this app.</p>
                <p>Note: iOS has (seemingly) unfixable issues.</p>
                <button class="b1" onclick="stcam();fesw('enablecam', 'cameraitself');">Grant</button>
            </div>
            <div id="cameraitself" style="display: none;">
                <video autoplay="true" class="embed" id="videl" style="margin-bottom: 3px;"></video>
                <button class="b1" onclick="nocam();fesw('cameraitself', 'enablecam');">Back</button><button class="b1"
                    onclick="snap();">Take Picture</button><button class="b1"
                    onclick="fesw('cameraitself', 'snapper');">Timer</button>
            </div>
            <div id="snapper" style="display: none;">
                <p>Timer</p>
                <p>Click one of the options below to start a photo timer</p>
                <button class="b1" onclick="tsnap(3000, 3);">3s</button><button class="b1"
                    onclick="tsnap(6000, 6);">6s</button><button class="b1" onclick="tsnap(9000, 9);">9s</button><button
                    class="b1" onclick="tsnap(12000, 12);">12s</button>
                <p><button class="b1" onclick="fesw('snapper', 'cameraitself');">Back</button></p>
            </div>
            <div id="savewherecam" style="display: none;">
                <p>Picture taken! Save to:</p>
                <button class="b1" onclick="savetodev();">Device</button><button class="b1"
                    onclick="savetofiles();">WebDesk Files</button>
                <p><button class="b1" onclick="fesw('savewherecam', 'cameraitself');">Back</button></p>
            </div>
        </div>
        <script src="./assets/apps/camera.js"></script>
    </div>
    <!--End of camera-->
    <div class="window" id="filem" style="width: 400px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('filem');"></div>
                <div class="winb yel" onmousedown="mini('filem');"></div>
                <div class="winb gre" onmousedown="max('filem');"></div>
            </div>
            <div class="title">Files</div>
        </div>
        <div class="content">
            <div id="breadcrumbs"></div>
            <div id="directoryContents"></div>
        </div>
    </div>
    <div class="window" id="store" style="width: 340px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('store');"></div>
                <div class="winb yel" onmousedown="mini('store');"></div>
                <div class="winb"></div>
            </div>
            <div class="title"><button class="b4" onclick="fesw('storebox', 'webappi');">Add</button> Store</div>
        </div>
        <div class="content" style="padding-bottom: 0px !important;">
            <p>Apps have full, unlimited access to your WebDesk. Only install apps you trust.</p>
            <p>Safe apps will be marked like this: <span class="safe">Safe</span></p>
        </div>
        <div class="content" id="storebox">
            <p>Error listing apps. Try a reboot!</p>
            <button class="b1" onclick="reboot(400);">Reboot</button>
        </div>
        <div class="content hide" id="webappi">
            <p>Install custom app</p>
            <p>Enter the link to it's file, and name the app.</p>
            <input class="i1" placeholder="App file link" id="custappl"></input>
            <input class="i1" placeholder="App name" id="custappn"></input>
            <button class="b1" onclick="fesw('webbappi', 'storebox');">Back</button><button class="b1"
                onclick="addapp(document.getElementById('custappn').value, document.getElementById('custappl').value);">Install!</button>
        </div>
    </div>
    <div class="window" id="caller" style="width: 260px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('caller');endcall();"></div>
                <div class="winb yel" onmousedown="mini('caller');"></div>
                <div class="winb"></div>
            </div>
            <div class="title">WebCall</div>
        </div>
        <div class="content" id="caller1">
            <p>Enter DeskID of person to call</p>
            <p class="smt">Previous calls:</p>
            <div id="prevcall" style="margin-bottom: 3px;"></div>
            <input class="i1" id="callerbox" placeholder="DeskID here"></input>
            <button class="b1" onclick="calldesk(document.getElementById('callerbox').value);">Call</button>
        </div>
        <div class="content hide" id="caller2">
            <p class="h3 callname">user</p>
            <p><span class="mutestat med">Unmuted</span> - <span class="med">Connected</span></p>
            <button class="b1" onclick="togglemute();">Toggle mute</button><button class="b1"
                onclick="endcall();">End</button>
        </div>
        <div class="content hide" id="caller3">
            <p class="h3">Calling...</p>
            <p>The other person can accept or deny.</p>
            <button class="b1" onclick="endcall();fesw('caller3', 'caller1');">End Call</button>
        </div>
    </div>
    <div class="window" id="calleri" style="width: 260px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('calleri');endcall('no');"></div>
                <div class="winb"></div>
                <div class="winb"></div>
            </div>
            <div class="title">WebCall</div>
        </div>
        <div class="content">
            <p class="h3 callname">user</p>
            <p>would like to call you</p>
            <button class="b1"
                onclick="endcall();clapp('calleri');custf(callid, 'DeclineCall-WebKey');">Decline</button><button
                class="b1" onclick="endcall('no');clapp('calleri');startcall(globcall);">Accept</button>
        </div>
    </div>
    <div class="window" id="backup" style="width: 320px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('backup');"></div>
                <div class="winb yel" onmousedown="mini('backup');"></div>
                <div class="winb"></div>
            </div>
            <div class="title">Backup</div>
        </div>
        <div class="content" id="back1">
            <p class="h3">Welcome!</p>
            <p class="smt">What do you want to do? Local backup downloads your WebDesk to your files, Migrate copies
                this WebDesk to a new WebDesk.</p>
            <button class="b1 b2" onclick="lback();">Make local backup</button>
            <button class="b1 b2" onclick="fesw('back1', 'back2')">Migrate</button>
        </div>
        <div id="back2" class="hide content">
            <p class="h3">Migration</p>
            <p>Enter the ID shown below on the other WebDesk, and hit "Move".</p>
            <p>Migration can take 2 seconds to several hours, depending on how much data you have.</p>
            <p class="moveprog">Progress will show here</p>
            <input class="i1" id="maway" placeholder="ID here..."></input>
            <button class="b1" onclick="fesw('back2', 'back1');">Back</button><button class="b1"
                onclick="migaway(document.getElementById('maway').value);">Move</button>
        </div>
    </div>
    <div class="window" id="backupnew" style="width: 320px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb"></div>
                <div class="winb yel" onmousedown="mini('backup');"></div>
                <div class="winb"></div>
            </div>
            <div class="title">Migration Assistant</div>
        </div>
        <div id="back3" class="hide content">
            <p class="h3">Migrating...</p>
            <p>We're moving your data to the new beta.</p>
            <p>This might take a while.</p>
        </div>
    </div>
    <div class="window" id="sendf" style="width: 320px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="fname = undefined; fblob = undefined; clapp('sendf');"></div>
                <div class="winb"></div>
                <div class="winb"></div>
            </div>
            <div class="title">ID is <span class="mcode med">----</span></div>
        </div>
        <div class="content">
            <p>Sending "<span class="med fname">undefined</span>"</p>
            <p class="smt">Ask the other person to open Control Center, then enter their ID below.</p>
            <input id="sendi" placeholder="Enter DeskID" class="i1"></input>
            <button class="b1" onclick="fname = undefined; fblob = undefined; clapp('sendf');">Cancel</button><button
                class="b1" onclick="sendf(document.getElementById('sendi').value);">Send</button>
            <p>Previous recievers</p>
            <div id="prevsend">
                <p class="smt">You haven't sent a file to anyone yet.</p>
            </div>
        </div>
    </div>
    <div class="window" id="settings" style="width: 350px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('settings');"></div>
                <div class="winb yel" onmousedown="mini('settings');"></div>
                <div class="winb"></div>
            </div>
            <div class="title">Settings</div>
        </div>
        <div class="content">
            <div id="settmain">
                <button class="b1 b2" onclick="fesw('settmain', 'settapp');">Appearance</button>
                <button class="b1 b2" onclick="fesw('settmain', 'settwall');">Wallpaper</button>
                <button class="b1 b2" onclick="fesw('settmain', 'settsys');">System/UI</button>
                <button class="b1 b2" onclick="fesw('settmain', 'settgen');">General</button>
            </div>
            <div id="settapp" class="hide">
                <p class="h3">Appearance</p>
                <p class="med">Accent color</p>
                <button class="acb" style="background: rgb(210, 30, 30);" onclick="chacc('210, 30, 30');"></button>
                <button class="acb" style="background: rgb(210, 120, 30);" onclick="chacc('210, 120, 30');"></button>
                <button class="acb" style="background: rgb(210, 180, 20);" onclick="chacc('210, 180, 20');"></button>
                <button class="acb" style="background: rgb(50, 160, 20);" onclick="chacc('50, 160, 20');"></button>
                <button class="acb" style="background: rgb(40, 70, 235);" onclick="chacc('40, 70, 235');"></button>
                <button class="acb" style="background: rgb(120, 60, 235);" onclick="chacc('120, 60, 235');"></button>
                <button class="acb" style="background: rgb(180, 180, 180);" onclick="chacc('200, 200, 200');"></button>
                <p class="med">Theme</p>
                <button class="b1" onclick="appear('l');">Light mode</button><button class="b1" onclick="appear();">Dark
                    mode</button>
                <p style="margin-top: 2px;"><button class="b1 b2" onclick="fesw('settapp', 'settdock');">Dock
                        settings</button><button class="b1" onclick="fesw('settapp', 'settmain');">Back</button></p>
            </div>
            <div id="settdock" class="hide">
                <p class="h3">Dock settings</p>
                <p><input type="number" id="docksz" placeholder="Custom size (in px)" class="i1"></p><button class="b1"
                    onclick="docksize(document.getElementById('docksz').value + 'px');">Apply</button><button class="b1"
                    onclick="docksize('36px');">Small</button><button class="b1"
                    onclick="docksize('44px');">Medium</button><button class="b1"
                    onclick="docksize('52px');">Large</button>
                <p><button class="b1" onclick="fesw('settdock', 'settapp');">Back</button></p>
            </div>
            <div id="settwall" class="hide">
                <p class="h3">Wallpaper</p>
                <button class="b1 b2"
                    onclick="filepick('image/*', async function (file) {await writef('/user/info/wall', file); wl = await readf('/user/info/wall'); bgim(wl);});">Upload
                    a
                    file</button>
                <button class="b1 b2"
                    onclick="delf('/user/info/wall'); wal('<p>A reboot is required to finish removing the wallpaper.', 'reboot(300)', 'Reboot');">Remove
                    Wallpaper</button>
                <button class="b1" onclick="fesw('settwall', 'settmain');">Back</button>
            </div>
            <div id="settgen" class="hide">
                <p class="h3">General</p>
                <button class="b1 b2" onclick="idch();">Change
                    DeskID</button>
                <button class="b1 b2" onclick="eprompt();">Erase WebDesk</button>
                <button class="b1 b2" onclick="window.location.href = './rec.html';">Recovery (Reboot)</button>
                <button class="b1" onclick="fesw('settgen', 'settmain');">Back</button>
            </div>
            <div id="settsys" class="hide">
                <p class="h3">System</p>
                <p>Encryption</p>
                <button class="b1 b2 enchide" onclick="encdesk();">Enable Encryption</button>
                <button class="b1 b2 noenchide" onclick="changepass2();">Change Password</button>
                <button class="b1 b2 noenchide" onclick="decryw();">Disable Encryption</button>
                <button class="b1" onclick="fesw('settsys', 'settmain');">Back</button>
            </div>
        </div>
    </div>
    <div id="menubar">
        <div class="tnav">
            <button class="mb bold"
                onclick="cm(`<button onclick='upload();' class='b1 b2'>Add File</button><button onclick='reboot(300);' class='b1 b2'>Reboot WebDesk</button><button class='b1'>Close</button>`);">WebDesk</button>
        </div>
        <div class="title">
            <img src="./assets/img/no.svg" id="bi"></img>
            <button class="mb time" onclick="fesw('gomenu', 'contcent');"
                onmouseover="document.getElementById('taskapp').innerText = 'Control Center';showf('taskapp');"
                onmouseleave="hidef('taskapp');">--:--</button>
        </div>
    </div>
    <div id="notif">
    </div>
    <div id="contcent" class="centmen">
        <p class="h3">Control Center</p>
        <p class="lockdown">Your DeskID is <span class="mcode bold">----</span></p>
        <button class="controlb" id="siltog"
            onclick="if (silent === true) {silent=false;nvol=1.0;togcls('siltog', 'controlba');snack('Disabled Silent Mode.');play('./assets/other/webdrop.ogg');} else {silent=true;nvol=0;togcls('siltog', 'controlba');snack('Enabled Silent Mode.');}">Silent</button><button
            class="controlb controlba lockdown" id="webdroptog"
            onclick="if (webdrop === true) { togcls('webdroptog', 'controlba'); webdrop = false; snack('Disabled WebDrop.'); } else { togcls('webdroptog', 'controlba'); webdrop = true; snack('Enabled WebDrop.'); }">WebDrop</button><button
            class="controlb" id="darktog"
            onclick="if (dark === true) {dark=false;togcls('darktog', 'controlba');snack('Disabled Dark Mode.');appear('l');} else {dark=true;snack('Enabled Dark Mode.');appear();}">Dark
            Mode</button>
        <p class="med" style="margin-top: 3px; margin-bottom: 3px">Notifications (select to delete)</p>
        <div id="notifold">
            <div class="notif2" id="defnotif">No notifications yet.</div>
        </div>
        <button class="b1" style="margin-top: 7px; width: 60%;" onclick="toggle('contcent');">Close</button>
    </div>
    <div id="gomenu" class="centmen">
        <p class="h3">Hello, <span class="uname"></span>!</p>
        <p class="smt glancew" style="margin-bottom: 5px;"></p>
        <div id="applist"><button class="b1" onclick="about();">About</button><button class="b1"
                onclick="opapp('backup', 'Backup');">Backup</button><button class="b1"
                onclick="opapp('camera', 'Camera');">Camera</button><button class="b1"
                onclick="opapp('filem', 'Files', './assets/img/apps/files.svg');dfm('/');">Files</button><button
                class="b1" onclick="opapp('store', 'Store');">Store</button><button class="b1"
                onclick="opapp('settings', 'Settings', './assets/img/apps/settings.svg');">Settings</button><button
                class="b1" onclick="opapp('caller', 'WebCall');">WebCall</button></div>
        <button class="b1" style="margin-top: 6px; width: 60%;" onclick="toggle('gomenu');">Close</button>
    </div>
    <div id="taskapp"
        style="position: fixed; display: none; left: 50%; top: 50%; transform: translate(-50%, -50%); background-color: var(--lightdark2); padding: 6px; border-radius: var(--rad2); border: 1px solid var(--bordercolor); z-index: 9970; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 75px 20px;"
        onclick="hidef('taskapp', '140');">Application</div>
    <div id="taskbar"><img class="tbi" onclick="hidef('contcent');toggle('gomenu');" id="gobtn"
            src="./assets/img/launch.svg"></img><span id="taskbara"></span></div>
    <script src="./assets/lib/jszip.js"></script>
    <script src="./assets/lib/peer.js"></script>
    <script src="./assets/lib/enc.js"></script>
    <script src="./assets/lib/jq.js"></script>
    <script src="./assets/code/fs.js"></script>
    <script src="./assets/code/misc.js"></script>
    <script src="./assets/code/ui.js"></script>
    <script src="./assets/code/wm.js"></script>
    <script src="./assets/code/core.js"></script>
    <script src="./assets/code/init.js"></script>
    <script src="./assets/apps/webcall.js"></script>
    <script src="./assets/code/send.js"></script>
    <script src="./assets/apps/about.js"></script>
    <script src="./assets/apps/auth.js"></script>
    <script src="./assets/apps/files.js"></script>
    <script src="./assets/apps/weather.js"></script>
    <script src="./assets/apps/store.js"></script>
    <script>
        async function boots1() {
            try {
                hidef('menubar', 0);
                hidef('taskbar', 0);
                await initializeDB();

                const [enc2, silly, deskid] = await Promise.all([
                    readpb('enc'),
                    readf('/system/setupon'),
                    readpb('deskid')
                ]);

                if (urlv('restore') === "y") {
                    showf('setup');
                    fesw('setup1', 'setupre');
                    hidecls('resthide');
                    hidef('deathcurtain', 450);
                    dest('setupgo', 0);
                    return;
                }

                if (silly !== undefined) {
                    sdone = true;
                    dest('setupgo', 0);
                    if (enc2 === "y") {
                        enc = "y";
                        showf('setup');
                        pw('Enter password to continue.', 'boots2()');
                        hidecls('enchide');
                        showcls('noenchide');
                    } else {
                        showf('setup');
                        fesw('setup1', 'setupa');
                        fesw('setupa1', 'setupa2');
                        hidecls('noenchide');
                        showcls('enchide');
                    }
                } else {
                    locked = false;
                    eraseall();
                    showf('setupbg');
                    await writef('/user/info/accent', '100, 5, 255');
                }

                const fucker = gen(7);

                if (deskid === null) {
                    await writepb('deskid', fucker);
                    dserv(fucker);
                    console.log(`<!> Created DeskID: ${fucker}`);
                } else if (deskid.length == 4) {
                    await writepb('deskid', fucker);
                    dserv(fucker);
                } else {
                    dserv(deskid);
                }

                hidef('deathcurtain', 450);
                console.log(`<i> Boot successful!`);
            } catch (error) {
                panic('2', error);
            }
        }

        var wl;

        async function boots2() {
            try {
                await clboot();
                locked = false;
                hidef('oobespace', '160');

                const [name, appear2, accent, fucker, wall] = await Promise.all([
                    readf('/user/info/name'),
                    readf('/user/info/appear'),
                    readf('/user/info/accent'),
                    readf('/system/check'),
                    readf('/user/info/wall'),
                ]);

                if (fucker !== "DontModifyOrYouWillBrickWebDesk") {
                    panic('6', '/system/check is corrupted.');
                }

                if (appear2 === "dark") {
                    appear();
                } else {
                    appear('l');
                }

                if (accent) {
                    cv('accent', accent);
                }

                masschange('uname', name);
                user = name;
                showf('menubar');
                showf('taskbar');

                await Promise.all([
                    readjson(),
                    readapps(),
                    readcall(),
                    listapps(),
                    docksize(),
                    updateck()
                ]);

                refreshWeather();

                handlesilly((name, data) => {
                    writef(`/user/files/${name}`, data);
                });

                if (wall) {
                    bgim(wall);
                }

                showf('gomenu');


                writef('/readme.txt', `This is the root of your WebDesk. All of your data is stored here, and it's what gets copied when migrating. Do not touch anything in /system, or you might break your WebDesk. Have fun!`);
            } catch (error) {
                panic('3', error);
            }
        }

        $(document).ready(boots1);
    </script>
</body>

</html>